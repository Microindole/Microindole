name: Generate Metrics
on:
  schedule:
    - cron: "0 16 * * *"
  workflow_dispatch:
  push:
    branches: ["main"]

jobs:
  github-metrics:
    runs-on: ubuntu-latest
    permissions:
      contents: write
    steps:
      - name: Generate GitHub Metrics
        uses: lowlighter/metrics@latest
        with:
          token: ${{ secrets.GITHUB_TOKEN }}
          
          # 【布局核心】：开启大屏模式，让图表横向排布
          config_display: large
          
          # 【重点1：去油腻】
          # 将 base 设为空字符串！
          # 这会移除所有“0 stargazers, 0 packages”之类的纯文本列
          base: ""
          
          # 【重点2：语言条】
          # 虽然不是圆环，但这样配置会显示彩色进度条和百分比
          plugin_languages: yes
          plugin_languages_ignored: html, css  # 建议过滤掉 HTML/CSS，看纯代码能力
          plugin_languages_limit: 8
          plugin_languages_details: lines, percentage # 显示百分比数据
          plugin_languages_colors: github
          
          # 【重点3：全图形化】
          # 加入代码行数趋势图（看起来很专业）
          plugin_lines: yes
          
          # 加入编码习惯图（根据时间生成波形图）
          plugin_habits: yes
          plugin_habits_facts: no    # 不要文字
          plugin_habits_charts: yes  # 只要图表
          config_timezone: Asia/Shanghai

          # 输出设置
          output_action: commit
          committer_branch: output
          committer_message: "chore: update graphical metrics"
          filename: github-metrics.svg